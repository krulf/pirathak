#!/bin/bash

export gemtbesked=0
export pape=0

# Sæt hjem
hjem=$(pwd)/pirathavn

hjælp() {
    glow $hjem/.intro.md
}

start() {
    clear
    cd $hjem
    glow .intro.md
}

cd() {
    if [[ "$@" == *"piratskibet"* ]]; then
	if [[ $gemtbesked = 0 ]]; then
	        echo "Kaptajnen vil have du finder beskeden før du kommer ombord"
	elif [[ $gemtbesked = 1 ]] && [[ $pape = 0 ]]; then
		echo "Du må besejre den skeløjede papegøje"
	elif [[ $gemtbesked = 1 ]] && [[ $pape = 1 ]]; then
		builtin cd "$@"
	fi
    elif [[ $@ == "gemmested" ]] || [[ $@ == "gemmested/" ]]; then
        echo "Fedt du slap væk..!"
    elif [[ -d pirathavn ]] && [[ $@ == "pirathavn" ]] || [[ $@ == "pirathavn/" ]]; then
	echo
	echo "Velkommen til pirathavnen, tjek omgivelserne med: cat pirathavn"
	echo
	builtin cd "$@"
    else
        builtin cd "$@"
    fi
}

echo() {
	if [[ "$@" == "Skattekortet er begravet på øen Isolering" ]]; then
		builtin echo "$@"
		builtin echo 
		builtin echo "Hoved 2: Arrrh nej, det var ikke Isolering, men Loddetin - skriv det pirataspirant!"
		builtin echo
	elif [[ "$@" == "Skatteko"* ]]; then
		builtin echo
		builtin echo "Hoved $((1 + $RANDOM % 3)): Aaaarh! Prøv igen!"
		builtin echo 
	elif [[ "$@" == "Skattekortet er begravet på øen Loddetin" ]]; then
		builtin echo
		builtin echo "Hoved 1: Fjumrehoveder! Det var da slet ikke en skat! Skriv i stedet: Skattekortet er blevet væk"
		builtin echo
	elif [[ "$@" == "Skattekortet er blevet væk" ]]; then
		builtin echo
		builtin echo -e "Du træder lidt væk, da abens tre hoveder begynder at råbe og skrige og bide efter hinanden.\n\nKort efter løber aben ud af døren."
		builtin echo
	else
		builtin echo "$@"
	fi
}

alias piratflag='echo "# Sådan matroser....\n\n###I har nu fuldført denne opgaven og kan gå videre. Må vinden altid være i jeres sejl, og må skattejagterne aldrig ende!\n\nLykke og held! 🏴‍☠️💰" >> .næste_opgave.md | glow .næste_opgave.md'
